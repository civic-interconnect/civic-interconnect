{
  "$id": "https://raw.githubusercontent.com/civic-interconnect/civic-interconnect/main/schemas/cep.p3tag.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CEP Per-Post Provenance Tag",
  "description": "Record describing a P3Tag attached to an entity, exchange, content item, or external subject.",
  "type": "object",
  "allOf": [
    {
      "$ref": "https://raw.githubusercontent.com/civic-interconnect/civic-interconnect/main/schemas/cep.record-envelope.schema.json"
    },
    {
      "type": "object",
      "properties": {
        "recordKind": {
          "const": "p3tag"
        },
        "subjectKind": {
          "type": "string",
          "description": "The kind of subject this tag refers to.",
          "enum": ["entity", "exchange", "content", "external-url", "other"]
        },
        "subjectRef": {
          "type": "string",
          "description": "Reference to the subject (CEP id, URL, or other agreed identifier)."
        },
        "tagSourceUri": {
          "type": "string",
          "format": "uri",
          "description": "Source type for this tag, rooted in p3tag-source vocabulary."
        },
        "confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Optional confidence score for the tag."
        },
        "label": {
          "type": "string",
          "description": "Short label for the tag (for UI and grouping)."
        },
        "note": {
          "type": "string",
          "description": "Optional free-text note associated with the tag."
        }
      },
      "required": ["subjectKind", "subjectRef", "tagSourceUri"],
      "additionalProperties": true
    }
  ]
}
